#!/bin/csh -f
### set env variables


## We need to create
set COMPSET = BHISTC5
set RESOLN  = ne120_t12
set MACHINE = cheyenne
#setenv CESMROOT /global/project/projectdirs/ccsm1/people/nanr/cesm_tags/cesm1_3_beta17_${TAG}
#setenv CESMROOT /glade/work/nanr/cesm_tags/cesm1_3_beta17_${TAG}
#setenv CESMROOT /glade/work/nanr/cesm_tags/sandbox/cesm1_3_beta17_sehires36
setenv CESMROOT /gpfs/fs1/work/nanr/cesm_tags/cesm-ihesp-hires1.0.30/

set mbr = 9
setenv CASE b.e13.${COMPSET}.${RESOLN}.1920-2100.0${mbr}
#setenv CASEROOT /global/project/projectdirs/ccsm1/people/nanr/cases/cesm1_3/testCases/$CASE
#setenv CASEROOT /glade/work/nanr/ihesp/t12_tagTest/$CASE
setenv CASEROOT /glade/work/nanr/ihesp-HiRes/cases/ne120_t12/$CASE


#$CESMROOT/scripts/create_newcase -case $CASEROOT -res $RESOLN  -mach $MACHINE -compset $COMPSET -compiler $COMPILER
$CESMROOT/cime/scripts/create_newcase --case $CASEROOT --res $RESOLN  --mach $MACHINE --compset $COMPSET --run-unsupported

cd $CASEROOT

### modify case parameters
# ./xmlchange RUN_TYPE=hybrid
./xmlchange RUN_STARTDATE=1920-01-01
./xmlchange STOP_OPTION=nmonths


### -------------COMMENT OUT!!!
./xmlchange RUN_REFCASE=B.E.13.B1850C5.ne120_t12.sehires38.003
./xmlchange RUN_REFDATE=0021-01-01


./xmlchange STOP_N=12
./xmlchange DIN_LOC_ROOT='/glade/p/cesm/cseg/inputdata'
./xmlchange DIN_LOC_ROOT_CLMFORC='/glade/p/cesm/cseg/inputdata/atm/datm7'

./xmlchange NTASKS_ATM=7200
./xmlchange NTASKS_LND=1200
./xmlchange NTASKS_ICE=6000
./xmlchange NTASKS_OCN=2135
./xmlchange NTASKS_CPL=7200
./xmlchange NTASKS_ROF=1200
./xmlchange ROOTPE_OCN=7200
./xmlchange ROOTPE_ICE=1200


#./xmlchange -file env_run.xml   -id CPL_SEQ_OPTION  -val RASM_OPTION1
./xmlchange RUNDIR='/glade/scratch/nanr/$CASE/run'
./xmlchange EXEROOT='/glade/scratch/nanr/$CASE/bld'
./xmlchange GET_REFCASE=TRUE

./case.setup

#mv user_nl_cam user_nl_cam.`date +%m%d-%H%M`
#cat > user_nl_cam<<EOF
#/

#EOF

#mv user_nl_clm user_nl_clm.`date +%m%d-%H%M`
#cat > user_nl_clm<<EOF
#EOF

#mv user_nl_pop user_nl_pop.`date +%m%d-%H%M`
#cat > user_nl_pop<<EOF
#EOF

#qcmd -- ./$CASE.build
