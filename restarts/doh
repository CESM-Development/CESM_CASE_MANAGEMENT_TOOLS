

setenv CESM2_TOOLS_ROOT /glade/work/nanr/cesm_tags/CASE_tools/cesm2-smyle/
setenv CESM2_TOOLS_ROOT /glade/work/nanr/cesm_tags/CASE_tools/cesm2-smyle/
setenv CESMROOT /glade/work/nanr/cesm_tags/cesm2.1.4-SMYLE
setenv CESMROOT /glade/work/nanr/cesm_tags/cesm2.1.4-SMYLE

if ( $HOST != casper10 ) then
if ( derecho4 != casper10 ) then
echo "ERROR:  Must be run on Casper"
echo ERROR:  Must be run on Casper
ERROR:  Must be run on Casper

endif
endif



set syr = 1991
set syr = 1991
set eyr = 1991
set eyr = 1991

@ ib = $syr
@ ib = 1991
@ ie = $eyr
@ ie = 1991

foreach year ( `seq $ib $ie` )
foreach year ( `seq $ib $ie` )
seq 1991 1991
foreach mon ( 08 )
foreach mon ( 08 )

set case = b.e30.SMYLE_IC.ne30pg3_t232_wg37.${year}-${mon}.01
set case = b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01

set Picdir = /glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/inputdata/cesm3_init/{$case}/
set Picdir = /glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/inputdata/cesm3_init/{b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01}/
set icdir = /glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/inputdata/cesm3_init/{$case}/${year}-${mon}-01
set icdir = /glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/inputdata/cesm3_init/{b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01}/1991-08-01

if ( ! -d ${Picdir} ) then
if ( ! -d /glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/inputdata/cesm3_init/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01/ ) then
mkdir ${Picdir}
mkdir /glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/inputdata/cesm3_init/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01/
endif
endif
if ( ! -d ${icdir} ) then
if ( ! -d /glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/inputdata/cesm3_init/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01/1991-08-01 ) then
mkdir ${icdir}
mkdir /glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/inputdata/cesm3_init/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01/1991-08-01
endif
endif


set doThis99 = 1
set doThis99 = 1
if ( $doThis99 == 1 ) then
if ( 1 == 1 ) then


set atmcase = ERA5_x_ne30np4_L58_rgC2_WO
set atmcase = ERA5_x_ne30np4_L58_rgC2_WO
set lndcase = ctsm53041_54surfdata_ne30_102_HIST
set lndcase = ctsm53041_54surfdata_ne30_102_HIST



set atmfname = ${atmcase}.${year}-${mon}-01-00000.nc
set atmfname = ERA5_x_ne30np4_L58_rgC2_WO.1991-08-01-00000.nc
set lndfname = ${lndcase}.clm2.r.${year}-${mon}-01-00000.nc
set lndfname = ctsm53041_54surfdata_ne30_102_HIST.clm2.r.1991-08-01-00000.nc
set roffname = ${lndcase}.mosart.r.${year}-${mon}-01-00000.nc
set roffname = ctsm53041_54surfdata_ne30_102_HIST.mosart.r.1991-08-01-00000.nc


set atmdir = /glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/ne30np4_L58_gll/
set atmdir = /glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/ne30np4_L58_gll/
set lnddir = /glade/derecho/scratch/wwieder/archive/ctsm53041_54surfdata_ne30_102_HIST/rest/${year}-${mon}-01-00000/
set lnddir = /glade/derecho/scratch/wwieder/archive/ctsm53041_54surfdata_ne30_102_HIST/rest/1991-08-01-00000/


set atmfout = ${case}.cam.i.${year}-${mon}-01-00000.nc
set atmfout = b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.cam.i.1991-08-01-00000.nc
set lndfout = ${case}.clm2.r.${year}-${mon}-01-00000.nc
set lndfout = b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.clm2.r.1991-08-01-00000.nc
set roffout = ${case}.mosart.r.${year}-${mon}-01-00000.nc
set roffout = b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.mosart.r.1991-08-01-00000.nc

echo $atmfout
echo b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.cam.i.1991-08-01-00000.nc
b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.cam.i.1991-08-01-00000.nc

set doThis = 1
set doThis = 1

if ( $doThis == 1 ) then
if ( 1 == 1 ) then
cp $atmdir/${atmfname} $icdir/$atmfout
cp /glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/ne30np4_L58_gll//ERA5_x_ne30np4_L58_rgC2_WO.1991-08-01-00000.nc /glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/inputdata/cesm3_init/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01/1991-08-01/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.cam.i.1991-08-01-00000.nc
cp: cannot open '/glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/ne30np4_L58_gll//ERA5_x_ne30np4_L58_rgC2_WO.1991-08-01-00000.nc' for reading: Permission denied
cp $lnddir/${lndfname} $icdir/$lndfout
cp /glade/derecho/scratch/wwieder/archive/ctsm53041_54surfdata_ne30_102_HIST/rest/1991-08-01-00000//ctsm53041_54surfdata_ne30_102_HIST.clm2.r.1991-08-01-00000.nc /glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/inputdata/cesm3_init/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01/1991-08-01/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.clm2.r.1991-08-01-00000.nc
cp $lnddir/${roffname} $icdir/$roffout
cp /glade/derecho/scratch/wwieder/archive/ctsm53041_54surfdata_ne30_102_HIST/rest/1991-08-01-00000//ctsm53041_54surfdata_ne30_102_HIST.mosart.r.1991-08-01-00000.nc /glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/inputdata/cesm3_init/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01/1991-08-01/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.mosart.r.1991-08-01-00000.nc
ncatted -a OriginalFile,global,a,c,$atmfname $icdir/$atmfout
ncatted -a OriginalFile,global,a,c,ERA5_x_ne30np4_L58_rgC2_WO.1991-08-01-00000.nc /glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/inputdata/cesm3_init/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01/1991-08-01/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.cam.i.1991-08-01-00000.nc
ncatted: ERROR file "/glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/inputdata/cesm3_init/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01/1991-08-01/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.cam.i.1991-08-01-00000.nc" not found. It does not exist on the local filesystem, nor does it match remote filename patterns (e.g., http://foo or foo.bar.edu:file).
ncatted: HINT file-not-found errors usually arise from filename typos, incorrect paths, missing files, or capricious gods. Please verify spelling and location of requested file. If the file resides on a High Performance Storage System (HPSS) accessible via the 'hsi' command, then add the --hpss option and re-try command.
ncatted -a OriginalFile,global,a,c,$lndfname $icdir/$lndfout
ncatted -a OriginalFile,global,a,c,ctsm53041_54surfdata_ne30_102_HIST.clm2.r.1991-08-01-00000.nc /glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/inputdata/cesm3_init/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01/1991-08-01/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.clm2.r.1991-08-01-00000.nc
ncatted -a OriginalFile,global,a,c,$roffname $icdir/$roffout
ncatted -a OriginalFile,global,a,c,ctsm53041_54surfdata_ne30_102_HIST.mosart.r.1991-08-01-00000.nc /glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/inputdata/cesm3_init/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01/1991-08-01/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.mosart.r.1991-08-01-00000.nc

endif
endif




set ocncase = g.e30_b06.GJRAv4.TL319_t232_wgx3_hycom1_N75.2025.081
set ocncase = g.e30_b06.GJRAv4.TL319_t232_wgx3_hycom1_N75.2025.081









set first_rest_year = 1958
set first_rest_year = 1958
set ocean_base_year = 62
set ocean_base_year = 62







@ offset = $first_rest_year - $ocean_base_year
@ offset = 1958 - 62
@ ocnyr = $year - $offset
@ ocnyr = 1991 - 1896
set pocnyr = `printf "%04d" $ocnyr`
set pocnyr = `printf "%04d" $ocnyr`
printf %04d 95
set ocndir = /glade/derecho/scratch/gmarques/archive/g.e30_b06.GJRAv4.TL319_t232_wgx3_hycom1_N75.2025.081/rest/${pocnyr}-${mon}-01-00000/
set ocndir = /glade/derecho/scratch/gmarques/archive/g.e30_b06.GJRAv4.TL319_t232_wgx3_hycom1_N75.2025.081/rest/0095-08-01-00000/

echo $ocndir
echo /glade/derecho/scratch/gmarques/archive/g.e30_b06.GJRAv4.TL319_t232_wgx3_hycom1_N75.2025.081/rest/0095-08-01-00000/
/glade/derecho/scratch/gmarques/archive/g.e30_b06.GJRAv4.TL319_t232_wgx3_hycom1_N75.2025.081/rest/0095-08-01-00000/

set icefout = ${case}.cice.r.${year}-${mon}-01-00000.nc
set icefout = b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.cice.r.1991-08-01-00000.nc
set lndfout = ${case}.clm2.r.${year}-${mon}-01-00000.nc
set lndfout = b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.clm2.r.1991-08-01-00000.nc
set roffout = ${case}.mosart.r.${year}-${mon}-01-00000.nc
set roffout = b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.mosart.r.1991-08-01-00000.nc

set icefname = ${ocncase}.cice.r.${pocnyr}-${mon}-01-00000.nc
set icefname = g.e30_b06.GJRAv4.TL319_t232_wgx3_hycom1_N75.2025.081.cice.r.0095-08-01-00000.nc
set poprfname = ${ocncase}.mom6.r.${pocnyr}-${mon}-01-00000.nc
set poprfname = g.e30_b06.GJRAv4.TL319_t232_wgx3_hycom1_N75.2025.081.mom6.r.0095-08-01-00000.nc
set popwwfname = ${ocncase}.ww3.r.${pocnyr}-${mon}-01-00000
set popwwfname = g.e30_b06.GJRAv4.TL319_t232_wgx3_hycom1_N75.2025.081.ww3.r.0095-08-01-00000
set poprfout = ${case}.mom6.r.${year}-${mon}-01-00000.nc
set poprfout = b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.mom6.r.1991-08-01-00000.nc
set popwwfout = ${case}.ww3.r.${year}-${mon}-01-00000
set popwwfout = b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.ww3.r.1991-08-01-00000



echo $icefname
echo g.e30_b06.GJRAv4.TL319_t232_wgx3_hycom1_N75.2025.081.cice.r.0095-08-01-00000.nc
g.e30_b06.GJRAv4.TL319_t232_wgx3_hycom1_N75.2025.081.cice.r.0095-08-01-00000.nc
echo $poprfname
echo g.e30_b06.GJRAv4.TL319_t232_wgx3_hycom1_N75.2025.081.mom6.r.0095-08-01-00000.nc
g.e30_b06.GJRAv4.TL319_t232_wgx3_hycom1_N75.2025.081.mom6.r.0095-08-01-00000.nc

set doThis2 = 1
set doThis2 = 1
if ( $doThis2 == 1 ) then
if ( 1 == 1 ) then

cp $ocndir/${icefname} $icdir/${icefout}
cp /glade/derecho/scratch/gmarques/archive/g.e30_b06.GJRAv4.TL319_t232_wgx3_hycom1_N75.2025.081/rest/0095-08-01-00000//g.e30_b06.GJRAv4.TL319_t232_wgx3_hycom1_N75.2025.081.cice.r.0095-08-01-00000.nc /glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/inputdata/cesm3_init/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01/1991-08-01/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.cice.r.1991-08-01-00000.nc
cp $ocndir/${poprfname} $icdir/${poprfout}
cp /glade/derecho/scratch/gmarques/archive/g.e30_b06.GJRAv4.TL319_t232_wgx3_hycom1_N75.2025.081/rest/0095-08-01-00000//g.e30_b06.GJRAv4.TL319_t232_wgx3_hycom1_N75.2025.081.mom6.r.0095-08-01-00000.nc /glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/inputdata/cesm3_init/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01/1991-08-01/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.mom6.r.1991-08-01-00000.nc


cp $ocndir/${popwwfname} $icdir/${popwwfout}
cp /glade/derecho/scratch/gmarques/archive/g.e30_b06.GJRAv4.TL319_t232_wgx3_hycom1_N75.2025.081/rest/0095-08-01-00000//g.e30_b06.GJRAv4.TL319_t232_wgx3_hycom1_N75.2025.081.ww3.r.0095-08-01-00000 /glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/inputdata/cesm3_init/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01/1991-08-01/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.ww3.r.1991-08-01-00000

ncatted -a OriginalFile,global,a,c,$icefname $icdir/$icefout
ncatted -a OriginalFile,global,a,c,g.e30_b06.GJRAv4.TL319_t232_wgx3_hycom1_N75.2025.081.cice.r.0095-08-01-00000.nc /glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/inputdata/cesm3_init/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01/1991-08-01/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.cice.r.1991-08-01-00000.nc
ncatted -a OriginalFile,global,a,c,$poprfname $icdir/$poprfout
ncatted -a OriginalFile,global,a,c,g.e30_b06.GJRAv4.TL319_t232_wgx3_hycom1_N75.2025.081.mom6.r.0095-08-01-00000.nc /glade/campaign/cesm/development/espwg/CESM3_ERA5_IC/inputdata/cesm3_init/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01/1991-08-01/b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.mom6.r.1991-08-01-00000.nc





echo "$case.cice.r.$year-${mon}-01-00000.nc" > ${icdir}/rpointer.ice.$year-${mon}-01-00000
echo b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.cice.r.1991-08-01-00000.nc
echo "$case.cam.r.$year-${mon}-01-00000.nc" > ${icdir}/rpointer.cam.$year-${mon}-01-00000
echo b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.cam.r.1991-08-01-00000.nc
echo "$case.cpl.r.$year-${mon}-01-00000.nc" > ${icdir}/rpointer.cpl.$year-${mon}-01-00000
echo b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.cpl.r.1991-08-01-00000.nc
echo "$case.clm2.r.$year-${mon}-01-00000.nc" > ${icdir}/rpointer.lnd.$year-${mon}-01-00000
echo b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.clm2.r.1991-08-01-00000.nc
echo "$case.mosart.r.$year-${mon}-01-00000.nc" > ${icdir}/rpointer.rof.$year-${mon}-01-00000
echo b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.mosart.r.1991-08-01-00000.nc
echo "$case.mom6.r.$year-${mon}-01-00000.nc" >> ${icdir}/rpointer.ocn.$year-${mon}-01-00000
echo b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.mom6.r.1991-08-01-00000.nc
echo "$case.dglc.r.$year-${mon}-01-00000.nc" >> ${icdir}/rpointer.glc.$year-${mon}-01-00000
echo b.e30.SMYLE_IC.ne30pg3_t232_wg37.1991-08.01.dglc.r.1991-08-01-00000.nc
echo "RESTART_FMT=nc" >> ${icdir}/rpointer.ocn.$year-${mon}-01-00000
echo RESTART_FMT=nc

endif
endif



endif
endif

end
end
end
end

exit
exit
